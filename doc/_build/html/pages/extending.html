<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extending fwdpy &#8212; fwdpy 0.0.4-rc3 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.4-rc3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Source code organization" href="code.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="code.html" title="Source code organization"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">fwdpy 0.0.4-rc3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="extending-fwdpy">
<h1>Extending <em>fwdpy</em><a class="headerlink" href="#extending-fwdpy" title="Permalink to this headline">¶</a></h1>
<p>It is possible to use <em>fwdpy</em> as the basis for other Python/Cython packages.  Once installed, you have access to both Cython and C++ declarations to use in your own code.  The Cython definitions are found in the &#8220;pxd&#8221; files that come with the source code and are installed with the package.  You use these in your own package via Cython&#8217;s &#8220;cimport&#8221; mechanism.  See the Cython documentation for details.</p>
<p>The &#8220;pxd&#8221; files give you access to C++ types (classes, structs, etc.), Cythons &#8220;extension types&#8221; (very similar to Python&#8217;s classes, but with the ability to have function implemented in another language), and functions.  With these files, you can write your own Cython code, should you ever find yourself needing direct access to the details of the C++ types.</p>
<p>The C++ headers give you direct access to different types of C++ constructs:</p>
<ol class="arabic simple">
<li>The raw types exposed by the &#8220;pxd&#8221; files.</li>
<li>C++ types and functions that cannot be exposed to Python via Cython.  Cython has limited support for &#8220;modern&#8221; C++11/C++14.</li>
<li>Low-level implementation details.</li>
</ol>
<p>You may use <em>fwdpy</em>&#8216;s headers directly in your own C++ code in order to write new routines for your own Python extension modules.</p>
<div class="section" id="including-the-c-headers">
<h2>Including the C++ headers<a class="headerlink" href="#including-the-c-headers" title="Permalink to this headline">¶</a></h2>
<p>In order to compile any extension based on <em>fwdpy</em> will require knowledge of where your Python installation installs header files that come with extension modules.  <strong>In general, this will be the trickiest part of making a module based on fwdpy.</strong>  The section is quite detailed, in order to help you out.</p>
<p>In general, there will be some ROOT directory where Python puts things.  What that ROOT is depend on how you installed a package.</p>
<p>For example, when I use python3 to install the package on my OS X machine using the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="c1">#We must use an OMP-enabled clang on OS X:</span>
$ <span class="nv">CC</span><span class="o">=</span>clang-omp <span class="nv">CXX</span><span class="o">=</span>clang-omp++ python3 setup.py install
</pre></div>
</div>
<p>I see this in the output:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ copying fwdpy/allele_ages.hpp -&gt; /usr/local/include/python3.5m/fwdpy
</pre></div>
</div>
<p>This tells me that I need to add <em>-I/usr/local/include/python3.5m/fwdpy</em> when compiling an extension module based on fwdpy.</p>
<p>Unfortunately, python does not seem to offer any automatic way of finding out where files are installed.  That said, python can give you hints:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">imp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="s1">&#39;fwdpy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fwdpy</span><span class="o">,</span><span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fwdpy</span><span class="o">.</span><span class="n">__file__</span><span class="p">)</span>
</pre></div>
</div>
<p>On my OS X machine, the latter gives:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;/usr/local/lib/python3.5/site-packages/fwdpy&#39;</span>
</pre></div>
</div>
<p>That path refers to where the <em>module itself</em> is installed.  The ROOT is /usr/local, you should be able to find the path to the headers with the help of our good friend bash:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ find /usr/local -name <span class="s2">&quot;*.hpp&quot;</span> <span class="p">|</span> grep fwdpy
</pre></div>
</div>
</div>
<div class="section" id="api-documentation">
<h2>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h2>
<p>Cython&#8217;s .pxd files have no analog to Python&#8217;s dosctrings.  However, those pxd files do tell you the name of the header where each C++ declaration can be found.  Those headers are (starting to be) documented into a reference manual using <a class="reference external" href="http://doxygen.org">doxygen</a>.  Currently, this is a work in progress.</p>
<p>To build the API documentation:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ./configure
$ doxygen fwdpy.doxygen
</pre></div>
</div>
<p>Then, point your browser to html/index.html.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Extending <em>fwdpy</em></a><ul>
<li><a class="reference internal" href="#including-the-c-headers">Including the C++ headers</a></li>
<li><a class="reference internal" href="#api-documentation">API Documentation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="code.html"
                        title="previous chapter">Source code organization</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pages/extending.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="code.html" title="Source code organization"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">fwdpy 0.0.4-rc3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Kevin Thornton.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>